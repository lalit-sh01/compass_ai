{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/lib/encryption/api-key-encryption.ts"],"sourcesContent":["/**\n * Validates an API key format (basic validation)\n * @param apiKey - The API key to validate\n * @param provider - The provider (e.g., 'openai')\n * @returns True if valid, false otherwise\n */\n\n/**\n * Validates an API key format (basic validation)\n * @param apiKey - The API key to validate\n * @param provider - The provider (e.g., 'openai')\n * @returns True if valid, false otherwise\n */\nexport function validateApiKeyFormat(apiKey: string, provider: 'openai' = 'openai'): boolean {\n  if (!apiKey || apiKey.trim() === '') {\n    return false\n  }\n\n  // Provider-specific validation\n  switch (provider) {\n    case 'openai':\n      // OpenAI keys start with 'sk-' and are typically 48+ characters\n      return apiKey.startsWith('sk-') && apiKey.length >= 20\n    default:\n      return apiKey.length >= 10\n  }\n}\n\n/**\n * Masks an API key for display purposes\n * @param apiKey - The API key to mask\n * @returns Masked version (e.g., \"sk-...xyz123\")\n */\nexport function maskApiKey(apiKey: string): string {\n  if (!apiKey || apiKey.length < 10) {\n    return '***'\n  }\n\n  const prefix = apiKey.substring(0, 3)\n  const suffix = apiKey.substring(apiKey.length - 6)\n  return `${prefix}...${suffix}`\n}\n"],"names":[],"mappings":"AAAA;;;;;CAKC,GAED;;;;;CAKC;;;;;;AACM,SAAS,qBAAqB,MAAc,EAAE,WAAqB,QAAQ;IAChF,IAAI,CAAC,UAAU,OAAO,IAAI,OAAO,IAAI;QACnC,OAAO;IACT;IAEA,+BAA+B;IAC/B,OAAQ;QACN,KAAK;YACH,gEAAgE;YAChE,OAAO,OAAO,UAAU,CAAC,UAAU,OAAO,MAAM,IAAI;QACtD;YACE,OAAO,OAAO,MAAM,IAAI;IAC5B;AACF;AAOO,SAAS,WAAW,MAAc;IACvC,IAAI,CAAC,UAAU,OAAO,MAAM,GAAG,IAAI;QACjC,OAAO;IACT;IAEA,MAAM,SAAS,OAAO,SAAS,CAAC,GAAG;IACnC,MAAM,SAAS,OAAO,SAAS,CAAC,OAAO,MAAM,GAAG;IAChD,OAAO,GAAG,OAAO,GAAG,EAAE,QAAQ;AAChC"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/settings/ApiKeySettings.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { validateApiKeyFormat, maskApiKey } from '@/lib/encryption/api-key-encryption'\nimport { useApiClient } from '@/lib/api-client'\n\ninterface ApiKeySettingsProps {\n  initialHasKey: boolean\n}\n\nexport default function ApiKeySettings({ initialHasKey }: ApiKeySettingsProps) {\n  const apiClient = useApiClient()\n  const [apiKey, setApiKey] = useState('')\n  const [hasKey, setHasKey] = useState(initialHasKey)\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [success, setSuccess] = useState<string | null>(null)\n  const [showKey, setShowKey] = useState(false)\n\n  const handleSaveKey = async () => {\n    setError(null)\n    setSuccess(null)\n\n    // Validate format\n    if (!validateApiKeyFormat(apiKey, 'openai')) {\n      setError('Invalid OpenAI API key format. Keys should start with \"sk-\" and be at least 20 characters.')\n      return\n    }\n\n    setIsLoading(true)\n\n    try {\n      await apiClient.post('/api/users/api-keys', {\n        apiKey,\n        provider: 'openai'\n      })\n\n      setSuccess('API key saved successfully!')\n      setHasKey(true)\n      setApiKey('')\n    } catch (err) {\n      setError((err as Error).message)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const handleDeleteKey = async () => {\n    if (!confirm('Are you sure you want to delete your API key? You will not be able to generate new roadmaps without it.')) {\n      return\n    }\n\n    setIsLoading(true)\n    setError(null)\n    setSuccess(null)\n\n    try {\n      await apiClient.delete('/api/users/api-keys?provider=openai')\n\n      setSuccess('API key deleted successfully')\n      setHasKey(false)\n    } catch (err) {\n      setError((err as Error).message)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* OpenAI API Key */}\n      <div className=\"border border-gray-200 rounded-lg p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"font-semibold text-gray-900\">OpenAI API Key</h3>\n            {hasKey && (\n              <span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                Active\n              </span>\n            )}\n          </div>\n        </div>\n\n        <p className=\"text-sm text-gray-600 mb-4\">\n          Get your API key from{' '}\n          <a\n            href=\"https://platform.openai.com/api-keys\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"text-blue-600 hover:text-blue-700 underline\"\n          >\n            OpenAI Platform\n          </a>\n        </p>\n\n        {hasKey ? (\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex-1 px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-sm text-gray-700 font-mono\">\n                sk-...â€¢â€¢â€¢â€¢â€¢â€¢\n              </div>\n              <button\n                onClick={handleDeleteKey}\n                disabled={isLoading}\n                className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium\"\n              >\n                {isLoading ? 'Deleting...' : 'Delete'}\n              </button>\n            </div>\n            <p className=\"text-xs text-gray-500\">\n              Your API key is encrypted and stored securely. Delete it if you want to add a new one.\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <label htmlFor=\"apiKey\" className=\"block text-sm font-medium text-gray-700\">\n                Enter your OpenAI API key\n              </label>\n              <input\n                type={showKey ? 'text' : 'password'}\n                id=\"apiKey\"\n                value={apiKey}\n                onChange={(e) => setApiKey(e.target.value)}\n                placeholder=\"sk-...\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm\"\n              />\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"checkbox\"\n                  id=\"showKey\"\n                  checked={showKey}\n                  onChange={(e) => setShowKey(e.target.checked)}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <label htmlFor=\"showKey\" className=\"text-sm text-gray-600\">\n                  Show API key\n                </label>\n              </div>\n            </div>\n\n            <button\n              onClick={handleSaveKey}\n              disabled={!apiKey || isLoading}\n              className=\"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium\"\n            >\n              {isLoading ? 'Saving...' : 'Save API Key'}\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Error/Success Messages */}\n      {error && (\n        <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\n          <p className=\"text-sm text-red-800\">{error}</p>\n        </div>\n      )}\n\n      {success && (\n        <div className=\"p-4 bg-green-50 border border-green-200 rounded-lg\">\n          <p className=\"text-sm text-green-800\">{success}</p>\n        </div>\n      )}\n\n      {/* Security Notice */}\n      <div className=\"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n        <h4 className=\"text-sm font-semibold text-blue-900 mb-2\">ðŸ”’ Security Notice</h4>\n        <ul className=\"text-sm text-blue-800 space-y-1 list-disc list-inside\">\n          <li>Your API keys are encrypted using AES-256 encryption</li>\n          <li>Keys are only decrypted when generating roadmaps</li>\n          <li>We never share or expose your API keys</li>\n          <li>You can delete your API key at any time</li>\n        </ul>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}