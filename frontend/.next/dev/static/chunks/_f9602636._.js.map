{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/lib/progress/tracker.ts"],"sourcesContent":["import { Roadmap } from '@/lib/types';\n\nexport type EntityType = 'deliverable' | 'topic' | 'subtask' | 'week' | 'phase';\n\nexport interface ProgressItem {\n    id: string; // Unique ID (e.g., \"w1-d1\", \"w2-t3-s1\")\n    roadmapId: string;\n    entityType: EntityType;\n    isCompleted: boolean;\n    completedAt?: string;\n    notes?: string;\n    rating?: number;\n}\n\nexport interface ProgressState {\n    overall: number; // 0-100\n    phases: Record<number, number>; // phase number -> %\n    weeks: Record<number, number>; // week number -> %\n    items: Record<string, ProgressItem>; // itemId -> item\n}\n\nexport function generateItemId(\n    weekNumber: number,\n    type: 'deliverable' | 'topic' | 'subtask' | 'resource',\n    index: number,\n    section?: string,\n    parentIndex?: number\n): string {\n    if (type === 'subtask' && parentIndex !== undefined) {\n        return `w${weekNumber}-t${parentIndex}-s${index}`;\n    }\n    if (type === 'resource') {\n        // section can be used for topic ID or general section\n        const sectionSuffix = section ? `-${section}` : '';\n        return `w${weekNumber}-r${index}${sectionSuffix}`;\n    }\n    const prefix = type === 'deliverable' ? 'd' : 't';\n    const sectionSuffix = section ? `-${section}` : '';\n    return `w${weekNumber}-${prefix}${index}${sectionSuffix}`;\n}\n\nexport function parseItemId(itemId: string): {\n    weekNumber: number;\n    type: 'deliverable' | 'topic' | 'subtask' | 'resource';\n    index: number;\n    section?: 'build' | 'research' | 'share' | string;\n    parentIndex?: number;\n    topicIndex?: number;\n} {\n    // Format: w1-d1-build, w1-t1, w1-t1-s1\n    const parts = itemId.split('-');\n    const weekNumber = parseInt(parts[0].substring(1));\n\n    if (parts.length >= 3 && parts[1].startsWith('t') && parts[2].startsWith('s')) {\n        // Subtask: w1-t1-s1\n        const parentIndex = parseInt(parts[1].substring(1));\n        const index = parseInt(parts[2].substring(1));\n        return { weekNumber, type: 'subtask', index, parentIndex };\n    }\n\n    // Resource: w1-r0-topic-0 or w1-r0-research\n    if (parts[1].startsWith('r')) {\n        const index = parseInt(parts[1].substring(1));\n        const sectionPart = parts.slice(2).join('-'); // topic-0 or research\n\n        let topicIndex: number | undefined;\n        if (sectionPart.startsWith('topic-')) {\n            topicIndex = parseInt(sectionPart.split('-')[1]);\n        }\n\n        return {\n            weekNumber,\n            type: 'resource',\n            index,\n            section: sectionPart as any, // Keep original string for flexibility\n            topicIndex\n        };\n    }\n\n    const typeChar = parts[1].charAt(0);\n    const index = parseInt(parts[1].substring(1));\n    const type = typeChar === 'd' ? 'deliverable' : 'topic';\n\n    let section: 'build' | 'research' | 'share' | undefined;\n    if (parts.length > 2 && !parts[2].startsWith('s')) {\n        section = parts[2] as 'build' | 'research' | 'share';\n    }\n\n    return { weekNumber, type, index, section };\n}\n\nexport function calculateProgress(total: number, completed: number): number {\n    if (total === 0) return 0;\n    return Math.round((completed / total) * 100);\n}\n"],"names":[],"mappings":";;;;;;;;AAqBO,SAAS,eACZ,UAAkB,EAClB,IAAsD,EACtD,KAAa,EACb,OAAgB,EAChB,WAAoB;IAEpB,IAAI,SAAS,aAAa,gBAAgB,WAAW;QACjD,OAAO,CAAC,CAAC,EAAE,WAAW,EAAE,EAAE,YAAY,EAAE,EAAE,OAAO;IACrD;IACA,IAAI,SAAS,YAAY;QACrB,sDAAsD;QACtD,MAAM,gBAAgB,UAAU,CAAC,CAAC,EAAE,SAAS,GAAG;QAChD,OAAO,CAAC,CAAC,EAAE,WAAW,EAAE,EAAE,QAAQ,eAAe;IACrD;IACA,MAAM,SAAS,SAAS,gBAAgB,MAAM;IAC9C,MAAM,gBAAgB,UAAU,CAAC,CAAC,EAAE,SAAS,GAAG;IAChD,OAAO,CAAC,CAAC,EAAE,WAAW,CAAC,EAAE,SAAS,QAAQ,eAAe;AAC7D;AAEO,SAAS,YAAY,MAAc;IAQtC,uCAAuC;IACvC,MAAM,QAAQ,OAAO,KAAK,CAAC;IAC3B,MAAM,aAAa,SAAS,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC;IAE/C,IAAI,MAAM,MAAM,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,MAAM;QAC3E,oBAAoB;QACpB,MAAM,cAAc,SAAS,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC;QAChD,MAAM,QAAQ,SAAS,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC;QAC1C,OAAO;YAAE;YAAY,MAAM;YAAW;YAAO;QAAY;IAC7D;IAEA,4CAA4C;IAC5C,IAAI,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,MAAM;QAC1B,MAAM,QAAQ,SAAS,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC;QAC1C,MAAM,cAAc,MAAM,KAAK,CAAC,GAAG,IAAI,CAAC,MAAM,sBAAsB;QAEpE,IAAI;QACJ,IAAI,YAAY,UAAU,CAAC,WAAW;YAClC,aAAa,SAAS,YAAY,KAAK,CAAC,IAAI,CAAC,EAAE;QACnD;QAEA,OAAO;YACH;YACA,MAAM;YACN;YACA,SAAS;YACT;QACJ;IACJ;IAEA,MAAM,WAAW,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC;IACjC,MAAM,QAAQ,SAAS,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC;IAC1C,MAAM,OAAO,aAAa,MAAM,gBAAgB;IAEhD,IAAI;IACJ,IAAI,MAAM,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,MAAM;QAC/C,UAAU,KAAK,CAAC,EAAE;IACtB;IAEA,OAAO;QAAE;QAAY;QAAM;QAAO;IAAQ;AAC9C;AAEO,SAAS,kBAAkB,KAAa,EAAE,SAAiB;IAC9D,IAAI,UAAU,GAAG,OAAO;IACxB,OAAO,KAAK,KAAK,CAAC,AAAC,YAAY,QAAS;AAC5C"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/viewer/actions/RemoveButton.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport { Trash2, AlertTriangle, X } from 'lucide-react';\n\ninterface RemoveButtonProps {\n    onRemove: () => void;\n    itemName: string;\n    disabled?: boolean;\n    className?: string;\n    iconSize?: number;\n}\n\nexport function RemoveButton({\n    onRemove,\n    itemName,\n    disabled = false,\n    className = \"\",\n    iconSize = 14\n}: RemoveButtonProps) {\n    const [isOpen, setIsOpen] = useState(false);\n    const dialogRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (dialogRef.current && !dialogRef.current.contains(event.target as Node)) {\n                setIsOpen(false);\n            }\n        };\n\n        if (isOpen) {\n            document.addEventListener('mousedown', handleClickOutside);\n        }\n\n        return () => {\n            document.removeEventListener('mousedown', handleClickOutside);\n        };\n    }, [isOpen]);\n\n    const handleConfirm = (e: React.MouseEvent) => {\n        e.stopPropagation();\n        onRemove();\n        setIsOpen(false);\n    };\n\n    const handleCancel = (e: React.MouseEvent) => {\n        e.stopPropagation();\n        setIsOpen(false);\n    };\n\n    const handleTrigger = (e: React.MouseEvent) => {\n        e.stopPropagation();\n        if (!disabled) {\n            setIsOpen(true);\n        }\n    };\n\n    return (\n        <div className=\"relative inline-block\">\n            <button\n                onClick={handleTrigger}\n                disabled={disabled}\n                className={`p-1 text-text-tertiary hover:text-red-600 rounded-sm hover:bg-red-50 transition-colors ${className}`}\n                title={`Remove ${itemName}`}\n                aria-label={`Remove ${itemName}`}\n            >\n                <Trash2 size={iconSize} />\n            </button>\n\n            {isOpen && (\n                <div className=\"absolute right-0 top-full mt-2 z-50 min-w-[280px] bg-surface rounded-md shadow-lg border border-border p-[var(--space-4)] animate-in fade-in zoom-in-95 duration-200 origin-top-right\">\n                    <div ref={dialogRef} className=\"space-y-3\">\n                        <div className=\"flex items-start gap-3\">\n                            <div className=\"p-2 bg-red-100 rounded-full shrink-0\">\n                                <AlertTriangle className=\"w-4 h-4 text-red-600\" />\n                            </div>\n                            <div>\n                                <h4 className=\"text-sm font-semibold text-text-primary\">\n                                    Remove Item?\n                                </h4>\n                                <p className=\"text-xs text-text-secondary mt-1\">\n                                    Are you sure you want to remove this {itemName}? This action cannot be undone.\n                                </p>\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end gap-2 mt-2\">\n                            <button\n                                onClick={handleCancel}\n                                className=\"px-3 py-1.5 text-xs font-medium text-text-secondary bg-transparent hover:bg-bg-secondary rounded-sm transition-colors\"\n                            >\n                                Cancel\n                            </button>\n                            <button\n                                onClick={handleConfirm}\n                                className=\"px-3 py-1.5 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded-sm transition-colors flex items-center gap-1.5\"\n                            >\n                                <Trash2 className=\"w-3 h-3\" />\n                                Remove\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAHA;;;AAaO,SAAS,aAAa,EACzB,QAAQ,EACR,QAAQ,EACR,WAAW,KAAK,EAChB,YAAY,EAAE,EACd,WAAW,EAAE,EACG;;IAChB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,YAAY,IAAA,uKAAM,EAAiB;IAEzC,IAAA,0KAAS;kCAAC;YACN,MAAM;6DAAqB,CAAC;oBACxB,IAAI,UAAU,OAAO,IAAI,CAAC,UAAU,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;wBACxE,UAAU;oBACd;gBACJ;;YAEA,IAAI,QAAQ;gBACR,SAAS,gBAAgB,CAAC,aAAa;YAC3C;YAEA;0CAAO;oBACH,SAAS,mBAAmB,CAAC,aAAa;gBAC9C;;QACJ;iCAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB,CAAC;QACnB,EAAE,eAAe;QACjB;QACA,UAAU;IACd;IAEA,MAAM,eAAe,CAAC;QAClB,EAAE,eAAe;QACjB,UAAU;IACd;IAEA,MAAM,gBAAgB,CAAC;QACnB,EAAE,eAAe;QACjB,IAAI,CAAC,UAAU;YACX,UAAU;QACd;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBACG,SAAS;gBACT,UAAU;gBACV,WAAW,CAAC,uFAAuF,EAAE,WAAW;gBAChH,OAAO,CAAC,OAAO,EAAE,UAAU;gBAC3B,cAAY,CAAC,OAAO,EAAE,UAAU;0BAEhC,cAAA,6LAAC,uNAAM;oBAAC,MAAM;;;;;;;;;;;YAGjB,wBACG,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAI,KAAK;oBAAW,WAAU;;sCAC3B,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC,4OAAa;wCAAC,WAAU;;;;;;;;;;;8CAE7B,6LAAC;;sDACG,6LAAC;4CAAG,WAAU;sDAA0C;;;;;;sDAGxD,6LAAC;4CAAE,WAAU;;gDAAmC;gDACN;gDAAS;;;;;;;;;;;;;;;;;;;sCAK3D,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCACG,SAAS;oCACT,WAAU;8CACb;;;;;;8CAGD,6LAAC;oCACG,SAAS;oCACT,WAAU;;sDAEV,6LAAC,uNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS9D;GA7FgB;KAAA"}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/context/SelectionContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useCallback } from 'react';\n\ninterface SelectionContextType {\n    selectedIds: Set<string>;\n    toggleSelection: (id: string) => void;\n    clearSelection: () => void;\n    selectAll: (ids: string[]) => void;\n    isSelected: (id: string) => boolean;\n    hasSelection: boolean;\n    selectionCount: number;\n    isSelectionMode: boolean;\n    toggleSelectionMode: () => void;\n}\n\nconst SelectionContext = createContext<SelectionContextType | undefined>(undefined);\n\nexport function SelectionProvider({ children }: { children: React.ReactNode }) {\n    const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n    const [isSelectionMode, setIsSelectionMode] = useState(false);\n\n    const toggleSelection = useCallback((id: string) => {\n        setSelectedIds(prev => {\n            const newSet = new Set(prev);\n            if (newSet.has(id)) {\n                newSet.delete(id);\n            } else {\n                newSet.add(id);\n            }\n            return newSet;\n        });\n    }, []);\n\n    const clearSelection = useCallback(() => {\n        setSelectedIds(new Set());\n        setIsSelectionMode(false);\n    }, []);\n\n    const selectAll = useCallback((ids: string[]) => {\n        setSelectedIds(new Set(ids));\n    }, []);\n\n    const isSelected = useCallback((id: string) => {\n        return selectedIds.has(id);\n    }, [selectedIds]);\n\n    const toggleSelectionMode = useCallback(() => {\n        setIsSelectionMode(prev => {\n            if (prev) {\n                // Exiting selection mode, clear selection\n                setSelectedIds(new Set());\n            }\n            return !prev;\n        });\n    }, []);\n\n    return (\n        <SelectionContext.Provider value={{\n            selectedIds,\n            toggleSelection,\n            clearSelection,\n            selectAll,\n            isSelected,\n            hasSelection: selectedIds.size > 0,\n            selectionCount: selectedIds.size,\n            isSelectionMode: isSelectionMode || selectedIds.size > 0, // Auto-enable if items are selected\n            toggleSelectionMode\n        }}>\n            {children}\n        </SelectionContext.Provider>\n    );\n}\n\nexport function useSelection() {\n    const context = useContext(SelectionContext);\n    if (context === undefined) {\n        throw new Error('useSelection must be used within a SelectionProvider');\n    }\n    return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAgBA,MAAM,iCAAmB,IAAA,8KAAa,EAAmC;AAElE,SAAS,kBAAkB,EAAE,QAAQ,EAAiC;;IACzE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAc,IAAI;IAChE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IAEvD,MAAM,kBAAkB,IAAA,4KAAW;0DAAC,CAAC;YACjC;kEAAe,CAAA;oBACX,MAAM,SAAS,IAAI,IAAI;oBACvB,IAAI,OAAO,GAAG,CAAC,KAAK;wBAChB,OAAO,MAAM,CAAC;oBAClB,OAAO;wBACH,OAAO,GAAG,CAAC;oBACf;oBACA,OAAO;gBACX;;QACJ;yDAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,4KAAW;yDAAC;YAC/B,eAAe,IAAI;YACnB,mBAAmB;QACvB;wDAAG,EAAE;IAEL,MAAM,YAAY,IAAA,4KAAW;oDAAC,CAAC;YAC3B,eAAe,IAAI,IAAI;QAC3B;mDAAG,EAAE;IAEL,MAAM,aAAa,IAAA,4KAAW;qDAAC,CAAC;YAC5B,OAAO,YAAY,GAAG,CAAC;QAC3B;oDAAG;QAAC;KAAY;IAEhB,MAAM,sBAAsB,IAAA,4KAAW;8DAAC;YACpC;sEAAmB,CAAA;oBACf,IAAI,MAAM;wBACN,0CAA0C;wBAC1C,eAAe,IAAI;oBACvB;oBACA,OAAO,CAAC;gBACZ;;QACJ;6DAAG,EAAE;IAEL,qBACI,6LAAC,iBAAiB,QAAQ;QAAC,OAAO;YAC9B;YACA;YACA;YACA;YACA;YACA,cAAc,YAAY,IAAI,GAAG;YACjC,gBAAgB,YAAY,IAAI;YAChC,iBAAiB,mBAAmB,YAAY,IAAI,GAAG;YACvD;QACJ;kBACK;;;;;;AAGb;GAtDgB;KAAA;AAwDT,SAAS;;IACZ,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACvB,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX;IANgB"}},
    {"offset": {"line": 379, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/lib/notes/note-utils.ts"],"sourcesContent":["/**\n * Utility functions for note operations\n */\n\nimport { Note } from './note-types';\n\n/**\n * Format a timestamp for display\n */\nexport function formatTimestamp(dateString: string): string {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return 'Just now';\n    if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;\n    if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\n    if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\n\n    return date.toLocaleDateString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        year: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined\n    });\n}\n\n/**\n * Truncate note content for preview\n */\nexport function truncateNote(content: string, maxLength: number = 100): string {\n    if (content.length <= maxLength) return content;\n    return content.substring(0, maxLength).trim() + '...';\n}\n\n/**\n * Basic markdown sanitization (remove potentially dangerous content)\n */\nexport function sanitizeMarkdown(content: string): string {\n    // Remove script tags and event handlers\n    let sanitized = content.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '');\n    sanitized = sanitized.replace(/on\\w+\\s*=\\s*[\"'][^\"']*[\"']/gi, '');\n    return sanitized;\n}\n\n/**\n * Check if a note is empty or whitespace only\n */\nexport function isNoteEmpty(content: string | undefined | null): boolean {\n    return !content || content.trim().length === 0;\n}\n\n/**\n * Get character count for display\n */\nexport function getCharacterCount(content: string): number {\n    return content.length;\n}\n\n/**\n * Check if content exceeds max length\n */\nexport function exceedsMaxLength(content: string, maxLength: number): boolean {\n    return content.length > maxLength;\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;AAOM,SAAS,gBAAgB,UAAkB;IAC9C,MAAM,OAAO,IAAI,KAAK;IACtB,MAAM,MAAM,IAAI;IAChB,MAAM,SAAS,IAAI,OAAO,KAAK,KAAK,OAAO;IAC3C,MAAM,WAAW,KAAK,KAAK,CAAC,SAAS;IACrC,MAAM,YAAY,KAAK,KAAK,CAAC,SAAS;IACtC,MAAM,WAAW,KAAK,KAAK,CAAC,SAAS;IAErC,IAAI,WAAW,GAAG,OAAO;IACzB,IAAI,WAAW,IAAI,OAAO,GAAG,SAAS,OAAO,EAAE,WAAW,IAAI,MAAM,GAAG,IAAI,CAAC;IAC5E,IAAI,YAAY,IAAI,OAAO,GAAG,UAAU,KAAK,EAAE,YAAY,IAAI,MAAM,GAAG,IAAI,CAAC;IAC7E,IAAI,WAAW,GAAG,OAAO,GAAG,SAAS,IAAI,EAAE,WAAW,IAAI,MAAM,GAAG,IAAI,CAAC;IAExE,OAAO,KAAK,kBAAkB,CAAC,SAAS;QACpC,OAAO;QACP,KAAK;QACL,MAAM,KAAK,WAAW,OAAO,IAAI,WAAW,KAAK,YAAY;IACjE;AACJ;AAKO,SAAS,aAAa,OAAe,EAAE,YAAoB,GAAG;IACjE,IAAI,QAAQ,MAAM,IAAI,WAAW,OAAO;IACxC,OAAO,QAAQ,SAAS,CAAC,GAAG,WAAW,IAAI,KAAK;AACpD;AAKO,SAAS,iBAAiB,OAAe;IAC5C,wCAAwC;IACxC,IAAI,YAAY,QAAQ,OAAO,CAAC,uDAAuD;IACvF,YAAY,UAAU,OAAO,CAAC,gCAAgC;IAC9D,OAAO;AACX;AAKO,SAAS,YAAY,OAAkC;IAC1D,OAAO,CAAC,WAAW,QAAQ,IAAI,GAAG,MAAM,KAAK;AACjD;AAKO,SAAS,kBAAkB,OAAe;IAC7C,OAAO,QAAQ,MAAM;AACzB;AAKO,SAAS,iBAAiB,OAAe,EAAE,SAAiB;IAC/D,OAAO,QAAQ,MAAM,GAAG;AAC5B"}},
    {"offset": {"line": 438, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/viewer/notes/NoteIcon.tsx"],"sourcesContent":["'use client';\n\nimport { FileText } from 'lucide-react';\nimport { isNoteEmpty, truncateNote } from '@/lib/notes/note-utils';\n\ninterface NoteIconProps {\n    content?: string;\n    onClick?: () => void;\n    className?: string;\n}\n\nexport function NoteIcon({ content, onClick, className = '' }: NoteIconProps) {\n    const hasNote = !isNoteEmpty(content);\n\n    if (!hasNote && !onClick) {\n        return null;\n    }\n\n    return (\n        <div className=\"relative group\">\n            <button\n                onClick={onClick}\n                className={`p-1 rounded transition-colors ${hasNote\n                        ? 'text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20'\n                        : 'text-gray-400 dark:text-gray-600 hover:text-gray-600 dark:hover:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'\n                    } ${className}`}\n                title={hasNote ? 'View note' : 'Add note'}\n            >\n                <FileText className=\"w-4 h-4\" />\n            </button>\n\n            {/* Tooltip preview on hover */}\n            {hasNote && content && (\n                <div className=\"absolute left-0 top-full mt-1 hidden group-hover:block z-10 w-64 p-2 bg-gray-900 dark:bg-gray-800 text-white text-xs rounded shadow-lg\">\n                    {truncateNote(content, 150)}\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAWO,SAAS,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,YAAY,EAAE,EAAiB;IACxE,MAAM,UAAU,CAAC,IAAA,+IAAW,EAAC;IAE7B,IAAI,CAAC,WAAW,CAAC,SAAS;QACtB,OAAO;IACX;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBACG,SAAS;gBACT,WAAW,CAAC,8BAA8B,EAAE,UAClC,gFACA,yHACL,CAAC,EAAE,WAAW;gBACnB,OAAO,UAAU,cAAc;0BAE/B,cAAA,6LAAC,6NAAQ;oBAAC,WAAU;;;;;;;;;;;YAIvB,WAAW,yBACR,6LAAC;gBAAI,WAAU;0BACV,IAAA,gJAAY,EAAC,SAAS;;;;;;;;;;;;AAK3C;KA5BgB"}},
    {"offset": {"line": 498, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/viewer/notes/NoteEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { FileText, Save, X, Clock } from 'lucide-react';\nimport { EntityType } from '@/lib/notes/note-types';\nimport { formatTimestamp, getCharacterCount, exceedsMaxLength } from '@/lib/notes/note-utils';\n\ninterface NoteEditorProps {\n    entityType: EntityType;\n    entityId: string;\n    initialContent?: string;\n    onSave: (content: string) => Promise<void>;\n    onCancel?: () => void;\n    placeholder?: string;\n    maxLength?: number;\n    autoFocus?: boolean;\n}\n\nexport function NoteEditor({\n    entityType,\n    entityId,\n    initialContent = '',\n    onSave,\n    onCancel,\n    placeholder = 'Add your notes here... (Markdown supported)',\n    maxLength = 2000,\n    autoFocus = false,\n}: NoteEditorProps) {\n    const [content, setContent] = useState(initialContent);\n    const [isSaving, setIsSaving] = useState(false);\n    const [lastSaved, setLastSaved] = useState<string | null>(null);\n    const [hasChanges, setHasChanges] = useState(false);\n    const autoSaveTimerRef = useRef<NodeJS.Timeout | null>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    const characterCount = getCharacterCount(content);\n    const isOverLimit = exceedsMaxLength(content, maxLength);\n\n    // Auto-focus if requested\n    useEffect(() => {\n        if (autoFocus && textareaRef.current) {\n            textareaRef.current.focus();\n        }\n    }, [autoFocus]);\n\n    // Auto-save logic\n    const performSave = useCallback(async () => {\n        if (!hasChanges || isSaving || isOverLimit) return;\n\n        setIsSaving(true);\n        try {\n            await onSave(content);\n            setLastSaved(new Date().toISOString());\n            setHasChanges(false);\n        } catch (error) {\n            console.error('Failed to save note:', error);\n        } finally {\n            setIsSaving(false);\n        }\n    }, [content, hasChanges, isSaving, isOverLimit, onSave]);\n\n    // Set up auto-save timer\n    useEffect(() => {\n        if (hasChanges && !isSaving) {\n            // Clear existing timer\n            if (autoSaveTimerRef.current) {\n                clearTimeout(autoSaveTimerRef.current);\n            }\n\n            // Set new timer for 3 seconds\n            autoSaveTimerRef.current = setTimeout(() => {\n                performSave();\n            }, 3000);\n        }\n\n        return () => {\n            if (autoSaveTimerRef.current) {\n                clearTimeout(autoSaveTimerRef.current);\n            }\n        };\n    }, [hasChanges, isSaving, performSave]);\n\n    const handleContentChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n        setContent(e.target.value);\n        setHasChanges(true);\n    };\n\n    const handleManualSave = async () => {\n        if (autoSaveTimerRef.current) {\n            clearTimeout(autoSaveTimerRef.current);\n        }\n        await performSave();\n    };\n\n    const handleCancel = () => {\n        if (autoSaveTimerRef.current) {\n            clearTimeout(autoSaveTimerRef.current);\n        }\n        setContent(initialContent);\n        setHasChanges(false);\n        onCancel?.();\n    };\n\n    return (\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-900\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\n                    <FileText className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">Note</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-500\">\n                    {lastSaved && (\n                        <div className=\"flex items-center gap-1\">\n                            <Clock className=\"w-3 h-3\" />\n                            <span>Saved {formatTimestamp(lastSaved)}</span>\n                        </div>\n                    )}\n                    {isSaving && <span className=\"text-blue-600 dark:text-blue-400\">Saving...</span>}\n                </div>\n            </div>\n\n            {/* Textarea */}\n            <textarea\n                ref={textareaRef}\n                value={content}\n                onChange={handleContentChange}\n                placeholder={placeholder}\n                className=\"w-full min-h-[120px] p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 resize-y\"\n                maxLength={maxLength}\n            />\n\n            {/* Footer */}\n            <div className=\"flex items-center justify-between mt-3\">\n                <div className=\"text-xs text-gray-500 dark:text-gray-500\">\n                    <span className={isOverLimit ? 'text-red-600 dark:text-red-400 font-medium' : ''}>\n                        {characterCount} / {maxLength}\n                    </span>\n                    {isOverLimit && <span className=\"ml-2 text-red-600 dark:text-red-400\">Character limit exceeded</span>}\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                    {onCancel && (\n                        <button\n                            onClick={handleCancel}\n                            className=\"px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors\"\n                        >\n                            <X className=\"w-4 h-4 inline mr-1\" />\n                            Cancel\n                        </button>\n                    )}\n                    <button\n                        onClick={handleManualSave}\n                        disabled={!hasChanges || isSaving || isOverLimit}\n                        className=\"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-1\"\n                    >\n                        <Save className=\"w-4 h-4\" />\n                        {isSaving ? 'Saving...' : 'Save'}\n                    </button>\n                </div>\n            </div>\n\n            {/* Markdown hint */}\n            <div className=\"mt-2 text-xs text-gray-400 dark:text-gray-600\">\n                Supports Markdown: **bold**, *italic*, [links](url), lists, etc.\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 804, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/hooks/useNotes.ts"],"sourcesContent":["/**\n * Hook for managing notes on roadmap entities\n */\n\nimport { useCallback } from 'react';\nimport { useRoadmap } from '@/context/RoadmapContext';\nimport { EntityType } from '@/lib/notes/note-types';\n\ninterface UseNotesOptions {\n    entityType: EntityType;\n    entityId: string;\n    weekNumber?: number;\n    section?: 'build' | 'research' | 'share';\n    topicIndex?: number;\n    deliverableIndex?: number;\n    resourceIndex?: number;\n}\n\nexport function useNotes(options: UseNotesOptions) {\n    const { roadmap, setRoadmapDirect } = useRoadmap();\n    const { entityType, weekNumber, section, topicIndex, deliverableIndex, resourceIndex } = options;\n\n    // Get current note content\n    const getCurrentNote = useCallback((): string | undefined => {\n        if (!roadmap || weekNumber === undefined) return undefined;\n\n        const phase = roadmap.phases.find(p => p.weeks.some(w => w.weekNumber === weekNumber));\n        if (!phase) return undefined;\n\n        const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n        if (!week) return undefined;\n\n        switch (entityType) {\n            case 'week':\n                return week.notes;\n\n            case 'deliverable':\n                if (deliverableIndex === undefined || !section) return undefined;\n                let deliverables;\n                if (section === 'build') deliverables = week.buildSection?.deliverables;\n                else if (section === 'research') deliverables = week.researchSection?.deliverables;\n                else if (section === 'share') deliverables = week.shareSection?.deliverables;\n                return deliverables?.[deliverableIndex]?.notes;\n\n            case 'topic':\n                if (topicIndex === undefined) return undefined;\n                return week.researchSection?.deepDiveTopics?.[topicIndex]?.notes;\n\n            case 'resource':\n                if (resourceIndex === undefined || topicIndex === undefined) return undefined;\n                return week.researchSection?.deepDiveTopics?.[topicIndex]?.suggestedResources?.[resourceIndex]?.notes;\n\n            default:\n                return undefined;\n        }\n    }, [roadmap, weekNumber, entityType, section, topicIndex, deliverableIndex, resourceIndex]);\n\n    // Save note\n    const saveNote = useCallback(async (content: string) => {\n        if (!roadmap || weekNumber === undefined) {\n            throw new Error('No roadmap loaded or invalid week number');\n        }\n\n        const updatedRoadmap = { ...roadmap };\n        const phase = updatedRoadmap.phases.find(p => p.weeks.some(w => w.weekNumber === weekNumber));\n        if (!phase) throw new Error('Phase not found');\n\n        const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n        if (!week) throw new Error('Week not found');\n\n        const timestamp = new Date().toISOString();\n\n        switch (entityType) {\n            case 'week':\n                week.notes = content;\n                break;\n\n            case 'deliverable':\n                if (deliverableIndex === undefined || !section) throw new Error('Invalid deliverable reference');\n                let deliverables;\n                if (section === 'build') deliverables = week.buildSection?.deliverables;\n                else if (section === 'research') deliverables = week.researchSection?.deliverables;\n                else if (section === 'share') deliverables = week.shareSection?.deliverables;\n                if (deliverables && deliverables[deliverableIndex]) {\n                    deliverables[deliverableIndex].notes = content;\n                }\n                break;\n\n            case 'topic':\n                if (topicIndex === undefined) throw new Error('Invalid topic reference');\n                const topic = week.researchSection?.deepDiveTopics?.[topicIndex];\n                if (topic) {\n                    topic.notes = content;\n                }\n                break;\n\n            case 'resource':\n                if (resourceIndex === undefined || topicIndex === undefined) throw new Error('Invalid resource reference');\n                const resource = week.researchSection?.deepDiveTopics?.[topicIndex]?.suggestedResources?.[resourceIndex];\n                if (resource) {\n                    resource.notes = content;\n                }\n                break;\n        }\n\n        setRoadmapDirect(updatedRoadmap);\n\n        // TODO: Call API to persist changes\n        // await fetch(`/api/notes`, {\n        //   method: 'POST',\n        //   body: JSON.stringify({ entityType, entityId, content, timestamp })\n        // });\n    }, [roadmap, weekNumber, entityType, section, topicIndex, deliverableIndex, resourceIndex, setRoadmapDirect]);\n\n    const currentNote = getCurrentNote();\n\n    return {\n        note: currentNote,\n        saveNote,\n    };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 946, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/viewer/editable/EditableDeliverable.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Check, Pencil, X, Save } from 'lucide-react';\nimport { Deliverable } from '@/lib/types';\nimport { generateItemId } from '@/lib/progress/tracker';\nimport { RemoveButton } from '../actions/RemoveButton';\nimport { useSelection } from '@/context/SelectionContext';\nimport { NoteIcon } from '../notes/NoteIcon';\nimport { NoteEditor } from '../notes/NoteEditor';\nimport { useNotes } from '@/hooks/useNotes';\n\ninterface EditableDeliverableProps {\n    deliverable: Deliverable;\n    weekNumber: number;\n    index: number;\n    section: 'build' | 'research' | 'share';\n    roadmapId: string;\n    isCompleted: boolean;\n    onToggle: (id: string, checked: boolean) => void;\n    onSave?: (id: string, newDescription: string) => void;\n    onRemove?: (id: string) => void;\n}\n\nexport function EditableDeliverable({\n    deliverable,\n    weekNumber,\n    index,\n    section,\n    roadmapId,\n    isCompleted,\n    onToggle,\n    onSave,\n    onRemove,\n}: EditableDeliverableProps) {\n    const [isEditing, setIsEditing] = useState(false);\n    const [isNoteOpen, setIsNoteOpen] = useState(false);\n    const [description, setDescription] = useState(deliverable.description);\n    const itemId = generateItemId(weekNumber, 'deliverable', index, section);\n\n    const { note, saveNote } = useNotes({\n        entityType: 'deliverable',\n        entityId: itemId,\n        weekNumber,\n        section,\n        deliverableIndex: index\n    });\n\n    const { isSelected, toggleSelection, isSelectionMode } = useSelection();\n    const selected = isSelected(itemId);\n    const showSelectionCheckbox = isSelectionMode; // Only show when in selection mode\n\n    const handleSave = () => {\n        if (onSave) {\n            onSave(itemId, description);\n        }\n        setIsEditing(false);\n    };\n\n    const handleCancel = () => {\n        setDescription(deliverable.description);\n        setIsEditing(false);\n    };\n\n    return (\n        <div className={`group flex items-start gap-3 p-2 rounded-lg transition-colors ${selected ? 'bg-blue-50 dark:bg-blue-900/20' : 'hover:bg-gray-50 dark:hover:bg-gray-800/50'\n            }`}>\n            {/* Selection checkbox - only visible when in selection mode */}\n            {showSelectionCheckbox && (\n                <div className=\"mt-1 flex items-center\">\n                    <input\n                        type=\"checkbox\"\n                        checked={selected}\n                        onChange={() => toggleSelection(itemId)}\n                        className=\"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-600 cursor-pointer\"\n                    />\n                </div>\n            )}\n\n            {/* Completion checkbox - only visible when NOT in selection mode */}\n            {!showSelectionCheckbox && (\n                <div className=\"mt-1\">\n                    <input\n                        type=\"checkbox\"\n                        checked={isCompleted}\n                        onChange={(e) => onToggle(itemId, e.target.checked)}\n                        className=\"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-600 cursor-pointer\"\n                    />\n                </div>\n            )}\n\n            <div className=\"flex-1 min-w-0\">\n                {isEditing ? (\n                    <div className=\"flex flex-col gap-2\">\n                        <textarea\n                            value={description}\n                            onChange={(e) => setDescription(e.target.value)}\n                            className=\"w-full p-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-700\"\n                            rows={2}\n                            autoFocus\n                        />\n                        <div className=\"flex gap-2\">\n                            <button\n                                onClick={handleSave}\n                                className=\"flex items-center gap-1 px-2 py-1 text-xs font-medium text-white bg-blue-600 rounded hover:bg-blue-700\"\n                            >\n                                <Save className=\"w-3 h-3\" /> Save\n                            </button>\n                            <button\n                                onClick={handleCancel}\n                                className=\"flex items-center gap-1 px-2 py-1 text-xs font-medium text-gray-600 bg-gray-100 rounded hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300\"\n                            >\n                                <X className=\"w-3 h-3\" /> Cancel\n                            </button>\n                        </div>\n                    </div>\n                ) : (\n                    <div className=\"relative group/text pr-16\">\n                        <p className={`text-sm ${isCompleted ? 'text-gray-400 line-through' : 'text-gray-700 dark:text-gray-300'}`}>\n                            {description}\n                        </p>\n                        {/* Edit controls - always available on hover (desktop) or always visible (mobile) */}\n                        <div className=\"absolute right-0 top-0 flex items-center gap-1 transition-opacity bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm rounded px-1 opacity-100 md:opacity-0 md:group-hover/text:opacity-100\">\n                            <button\n                                onClick={() => setIsEditing(true)}\n                                className=\"p-1 text-gray-400 hover:text-blue-600 transition-colors\"\n                                title=\"Edit deliverable\"\n                            >\n                                <Pencil className=\"w-3 h-3\" />\n                            </button>\n                            <NoteIcon\n                                content={note}\n                                onClick={() => setIsNoteOpen(!isNoteOpen)}\n                                className=\"p-1\"\n                            />\n                            {onRemove && (\n                                <RemoveButton\n                                    onRemove={() => onRemove(itemId)}\n                                    itemName=\"deliverable\"\n                                    iconSize={12}\n                                />\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                {/* Inline Note Editor */}\n                {isNoteOpen && (\n                    <div className=\"mt-2\">\n                        <NoteEditor\n                            entityType=\"deliverable\"\n                            entityId={itemId}\n                            initialContent={note}\n                            onSave={async (content) => {\n                                await saveNote(content);\n                                setIsNoteOpen(false);\n                            }}\n                            onCancel={() => setIsNoteOpen(false)}\n                            autoFocus\n                            placeholder=\"Add notes for this deliverable...\"\n                        />\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1214, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/viewer/dnd/DraggableDeliverable.tsx"],"sourcesContent":["'use client';\n\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { GripVertical } from 'lucide-react';\nimport { EditableDeliverable } from '../editable/EditableDeliverable';\nimport { Deliverable } from '@/lib/types';\n\ninterface DraggableDeliverableProps {\n    id: string;\n    deliverable: Deliverable;\n    weekNumber: number;\n    index: number;\n    section: 'build' | 'research' | 'share';\n    roadmapId: string;\n    isCompleted: boolean;\n    onToggle: (id: string, checked: boolean) => void;\n    onSave?: (id: string, newDescription: string) => void;\n    onRemove?: (id: string) => void;\n}\n\nexport function DraggableDeliverable({\n    id,\n    deliverable,\n    weekNumber,\n    index,\n    section,\n    roadmapId,\n    isCompleted,\n    onToggle,\n    onSave,\n    onRemove,\n}: DraggableDeliverableProps) {\n    const {\n        attributes,\n        listeners,\n        setNodeRef,\n        transform,\n        transition,\n        isDragging\n    } = useSortable({ id });\n\n    const style = {\n        transform: CSS.Transform.toString(transform),\n        transition,\n        opacity: isDragging ? 0.5 : 1,\n    };\n\n    return (\n        <div ref={setNodeRef} style={style} className=\"flex items-start gap-2 group/drag\">\n            <div\n                {...attributes}\n                {...listeners}\n                className=\"mt-3 cursor-grab active:cursor-grabbing text-gray-300 hover:text-gray-500 dark:text-gray-600 dark:hover:text-gray-400 opacity-0 group-hover/drag:opacity-100 transition-opacity\"\n            >\n                <GripVertical className=\"w-4 h-4\" />\n            </div>\n            <div className=\"flex-1\">\n                <EditableDeliverable\n                    deliverable={deliverable}\n                    weekNumber={weekNumber}\n                    index={index}\n                    section={section}\n                    roadmapId={roadmapId}\n                    isCompleted={isCompleted}\n                    onToggle={onToggle}\n                    onSave={onSave}\n                    onRemove={onRemove}\n                />\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAqBO,SAAS,qBAAqB,EACjC,EAAE,EACF,WAAW,EACX,UAAU,EACV,KAAK,EACL,OAAO,EACP,SAAS,EACT,WAAW,EACX,QAAQ,EACR,MAAM,EACN,QAAQ,EACgB;;IACxB,MAAM,EACF,UAAU,EACV,SAAS,EACT,UAAU,EACV,SAAS,EACT,UAAU,EACV,UAAU,EACb,GAAG,IAAA,qLAAW,EAAC;QAAE;IAAG;IAErB,MAAM,QAAQ;QACV,WAAW,+KAAG,CAAC,SAAS,CAAC,QAAQ,CAAC;QAClC;QACA,SAAS,aAAa,MAAM;IAChC;IAEA,qBACI,6LAAC;QAAI,KAAK;QAAY,OAAO;QAAO,WAAU;;0BAC1C,6LAAC;gBACI,GAAG,UAAU;gBACb,GAAG,SAAS;gBACb,WAAU;0BAEV,cAAA,6LAAC,yOAAY;oBAAC,WAAU;;;;;;;;;;;0BAE5B,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC,kLAAmB;oBAChB,aAAa;oBACb,YAAY;oBACZ,OAAO;oBACP,SAAS;oBACT,WAAW;oBACX,aAAa;oBACb,UAAU;oBACV,QAAQ;oBACR,UAAU;;;;;;;;;;;;;;;;;AAK9B;GAnDgB;;QAmBR,qLAAW;;;KAnBH"}},
    {"offset": {"line": 1305, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/lib/validation/guardrails.ts"],"sourcesContent":["/**\n * Guardrails System\n *\n * Three-tier guardrail system for roadmap editing:\n * - Tier 1: Structural (cannot override - hard constraints)\n * - Tier 2: Content (can edit with validation)\n * - Tier 3: Quality (warnings only, not blockers)\n */\n\nimport type { Roadmap } from '../types'\n\n// ============================================================================\n// Tier 1: Structural Guardrails (CANNOT OVERRIDE)\n// ============================================================================\n\nexport interface StructuralGuardrails {\n  totalDurationWeeks: number\n  phaseCount: number\n  weekNumbers: number[]\n\n  phaseWeekDistribution: {\n    min: number // Phase must have  this many weeks\n    max: number // Phase must have  this many weeks\n  }\n\n  hoursPerWeek: {\n    min: number // Must be  this many hours\n    max: number // Must be  this many hours\n  }\n}\n\nexport const DEFAULT_STRUCTURAL_GUARDRAILS: StructuralGuardrails = {\n  totalDurationWeeks: 0, // Set from original roadmap\n  phaseCount: 0, // Set from original roadmap\n  weekNumbers: [], // Set from original roadmap\n\n  phaseWeekDistribution: {\n    min: 2, // Phases must have at least 2 weeks\n    max: 8, // Phases cannot have more than 8 weeks\n  },\n\n  hoursPerWeek: {\n    min: 5, // Minimum 5 hours per week\n    max: 40, // Maximum 40 hours per week\n  },\n}\n\n/**\n * Extracts structural guardrails from original roadmap\n */\nexport function extractStructuralGuardrails(\n  roadmap: Roadmap\n): StructuralGuardrails {\n  const weekNumbers: number[] = []\n\n  roadmap.phases?.forEach(phase => {\n    phase.weeks?.forEach(week => {\n      weekNumbers.push(week.weekNumber)\n    })\n  })\n\n  return {\n    totalDurationWeeks: roadmap.totalDurationWeeks || 0,\n    phaseCount: roadmap.phases?.length || 0,\n    weekNumbers,\n    phaseWeekDistribution: DEFAULT_STRUCTURAL_GUARDRAILS.phaseWeekDistribution,\n    hoursPerWeek: DEFAULT_STRUCTURAL_GUARDRAILS.hoursPerWeek,\n  }\n}\n\n// ============================================================================\n// Tier 2: Content Guardrails (CAN EDIT WITH VALIDATION)\n// ============================================================================\n\nexport interface ContentGuardrails {\n  deliverables: {\n    minPerWeek: number\n    maxPerWeek: number\n    requiredFields: string[]\n    maxDescriptionLength: number\n  }\n\n  resources: {\n    minPerTopic: number\n    maxPerTopic: number\n    urlValidation: boolean\n    requiredFields: string[]\n  }\n\n  notes: {\n    maxLength: number\n    allowMarkdown: boolean\n  }\n\n  timeAllocation: {\n    buildPercentage: { min: number; max: number }\n    researchPercentage: { min: number; max: number }\n    sharePercentage: { min: number; max: number }\n  }\n\n  weekFields: {\n    titleMaxLength: number\n    themeMaxLength: number\n    descriptionMaxLength: number\n  }\n}\n\nexport const DEFAULT_CONTENT_GUARDRAILS: ContentGuardrails = {\n  deliverables: {\n    minPerWeek: 1, // At least 1 deliverable per week\n    maxPerWeek: 10, // Max 10 deliverables per week\n    requiredFields: ['description'],\n    maxDescriptionLength: 500,\n  },\n\n  resources: {\n    minPerTopic: 0, // Can remove all (but will get warning)\n    maxPerTopic: 20, // Max 20 resources per topic\n    urlValidation: true,\n    requiredFields: ['title', 'type'],\n  },\n\n  notes: {\n    maxLength: 5000, // 5000 character limit\n    allowMarkdown: true,\n  },\n\n  timeAllocation: {\n    buildPercentage: { min: 40, max: 80 }, // 40-80% on build\n    researchPercentage: { min: 10, max: 40 }, // 10-40% on research\n    sharePercentage: { min: 5, max: 25 }, // 5-25% on share\n  },\n\n  weekFields: {\n    titleMaxLength: 100,\n    themeMaxLength: 100,\n    descriptionMaxLength: 1000,\n  },\n}\n\n// ============================================================================\n// Tier 3: Quality Guardrails (WARNINGS, NOT BLOCKERS)\n// ============================================================================\n\nexport interface QualityWarning {\n  code: string\n  severity: 'warning' | 'info'\n  message: string\n  suggestion?: string\n  location?: {\n    phaseNumber?: number\n    weekNumber?: number\n  }\n}\n\nexport interface QualityGuardrails {\n  warnings: {\n    noResources: string\n    fewDeliverables: string\n    vagueTitles: string\n    noSubtasks: string\n    skippedWeeks: string\n    lowResourceQuality: string\n    missingUrls: string\n  }\n\n  suggestions: {\n    aiEnhancement: boolean\n    resourceRecommendations: boolean\n    deliverableSuggestions: boolean\n  }\n}\n\nexport const DEFAULT_QUALITY_GUARDRAILS: QualityGuardrails = {\n  warnings: {\n    noResources: 'Week has no resources - consider adding some',\n    fewDeliverables: 'Only 1 deliverable - consider adding 2-3 more for better granularity',\n    vagueTitles: 'Title is too generic - be more specific about what you\\'ll build',\n    noSubtasks: 'Topic has no subtasks - consider breaking it down into smaller steps',\n    skippedWeeks: 'You have skipped 3+ weeks - is this intentional?',\n    lowResourceQuality: 'Some resources are missing URLs or descriptions',\n    missingUrls: 'Resource is missing a URL - add a link for easy access',\n  },\n\n  suggestions: {\n    aiEnhancement: true,\n    resourceRecommendations: true,\n    deliverableSuggestions: true,\n  },\n}\n\n// ============================================================================\n// Validation Result Types\n// ============================================================================\n\nexport interface ValidationError {\n  code: string\n  severity: 'error' | 'warning' | 'info'\n  message: string\n  field?: string\n  location?: {\n    phaseNumber?: number\n    weekNumber?: number\n    deliverableIndex?: number\n    topicIndex?: number\n    resourceIndex?: number\n  }\n  suggestion?: string\n}\n\nexport interface ValidationResult {\n  valid: boolean\n  errors: ValidationError[]\n  warnings: QualityWarning[]\n}\n\n// ============================================================================\n// Validation Functions\n// ============================================================================\n\n/**\n * Validates structural constraints (Tier 1)\n */\nexport function validateStructuralConstraints(\n  roadmap: Roadmap,\n  guardrails: StructuralGuardrails\n): ValidationError[] {\n  const errors: ValidationError[] = []\n\n  // Check total duration hasn't changed\n  if (roadmap.totalDurationWeeks !== guardrails.totalDurationWeeks) {\n    errors.push({\n      code: 'DURATION_CHANGED',\n      severity: 'error',\n      message: `Total duration cannot be changed. Expected ${guardrails.totalDurationWeeks} weeks.`,\n      field: 'totalDurationWeeks',\n    })\n  }\n\n  // Check phase count hasn't changed\n  if (roadmap.phases?.length !== guardrails.phaseCount) {\n    errors.push({\n      code: 'PHASE_COUNT_CHANGED',\n      severity: 'error',\n      message: `Phase count cannot be changed. Expected ${guardrails.phaseCount} phases.`,\n      field: 'phases',\n    })\n  }\n\n  // Check week numbers are intact\n  const currentWeekNumbers: number[] = []\n  roadmap.phases?.forEach(phase => {\n    phase.weeks?.forEach(week => {\n      currentWeekNumbers.push(week.weekNumber)\n    })\n  })\n\n  const missingWeeks = guardrails.weekNumbers.filter(\n    n => !currentWeekNumbers.includes(n)\n  )\n  if (missingWeeks.length > 0) {\n    errors.push({\n      code: 'WEEKS_MISSING',\n      severity: 'error',\n      message: `Weeks cannot be deleted: ${missingWeeks.join(', ')}`,\n      field: 'weeks',\n    })\n  }\n\n  // Validate hours per week\n  roadmap.phases?.forEach((phase, phaseIndex) => {\n    phase.weeks?.forEach((week, weekIndex) => {\n      if (week.totalHours < guardrails.hoursPerWeek.min) {\n        errors.push({\n          code: 'HOURS_TOO_LOW',\n          severity: 'error',\n          message: `Week ${week.weekNumber} has ${week.totalHours} hours. Minimum is ${guardrails.hoursPerWeek.min}.`,\n          field: 'totalHours',\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n\n      if (week.totalHours > guardrails.hoursPerWeek.max) {\n        errors.push({\n          code: 'HOURS_TOO_HIGH',\n          severity: 'error',\n          message: `Week ${week.weekNumber} has ${week.totalHours} hours. Maximum is ${guardrails.hoursPerWeek.max}.`,\n          field: 'totalHours',\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n    })\n  })\n\n  return errors\n}\n\n/**\n * Validates content constraints (Tier 2)\n */\nexport function validateContentConstraints(\n  roadmap: Roadmap,\n  guardrails: ContentGuardrails\n): ValidationError[] {\n  const errors: ValidationError[] = []\n\n  roadmap.phases?.forEach(phase => {\n    phase.weeks?.forEach(week => {\n      // Validate deliverables\n      const deliverableCount = week.buildSection?.deliverables?.length || 0\n\n      if (deliverableCount < guardrails.deliverables.minPerWeek) {\n        errors.push({\n          code: 'TOO_FEW_DELIVERABLES',\n          severity: 'error',\n          message: `Week ${week.weekNumber} has ${deliverableCount} deliverable(s). Minimum is ${guardrails.deliverables.minPerWeek}.`,\n          field: 'deliverables',\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n\n      if (deliverableCount > guardrails.deliverables.maxPerWeek) {\n        errors.push({\n          code: 'TOO_MANY_DELIVERABLES',\n          severity: 'error',\n          message: `Week ${week.weekNumber} has ${deliverableCount} deliverables. Maximum is ${guardrails.deliverables.maxPerWeek}.`,\n          field: 'deliverables',\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n\n      // Validate each deliverable\n      week.buildSection?.deliverables?.forEach((deliverable, index) => {\n        if (!deliverable.description || deliverable.description.trim() === '') {\n          errors.push({\n            code: 'DELIVERABLE_NO_DESCRIPTION',\n            severity: 'error',\n            message: `Deliverable ${index + 1} in Week ${week.weekNumber} has no description.`,\n            field: 'deliverables.description',\n            location: {\n              phaseNumber: phase.phaseNumber,\n              weekNumber: week.weekNumber,\n              deliverableIndex: index,\n            },\n          })\n        }\n\n        if (deliverable.description?.length > guardrails.deliverables.maxDescriptionLength) {\n          errors.push({\n            code: 'DELIVERABLE_DESCRIPTION_TOO_LONG',\n            severity: 'error',\n            message: `Deliverable description in Week ${week.weekNumber} is too long. Maximum is ${guardrails.deliverables.maxDescriptionLength} characters.`,\n            field: 'deliverables.description',\n            location: {\n              phaseNumber: phase.phaseNumber,\n              weekNumber: week.weekNumber,\n              deliverableIndex: index,\n            },\n          })\n        }\n      })\n\n      // Validate resources\n      week.researchSection?.deepDiveTopics?.forEach((topic, topicIndex) => {\n        const resourceCount = topic.suggestedResources?.length || 0\n\n        if (resourceCount > guardrails.resources.maxPerTopic) {\n          errors.push({\n            code: 'TOO_MANY_RESOURCES',\n            severity: 'error',\n            message: `Topic ${topicIndex + 1} in Week ${week.weekNumber} has ${resourceCount} resources. Maximum is ${guardrails.resources.maxPerTopic}.`,\n            field: 'resources',\n            location: {\n              phaseNumber: phase.phaseNumber,\n              weekNumber: week.weekNumber,\n              topicIndex,\n            },\n          })\n        }\n\n        // Validate each resource\n        topic.suggestedResources?.forEach((resource, resourceIndex) => {\n          if (!resource.title || resource.title.trim() === '') {\n            errors.push({\n              code: 'RESOURCE_NO_TITLE',\n              severity: 'error',\n              message: `Resource ${resourceIndex + 1} in Week ${week.weekNumber} has no title.`,\n              field: 'resources.title',\n              location: {\n                phaseNumber: phase.phaseNumber,\n                weekNumber: week.weekNumber,\n                topicIndex,\n                resourceIndex,\n              },\n            })\n          }\n\n          if (guardrails.resources.urlValidation && resource.url) {\n            if (!isValidUrl(resource.url)) {\n              errors.push({\n                code: 'RESOURCE_INVALID_URL',\n                severity: 'error',\n                message: `Resource \"${resource.title}\" has an invalid URL.`,\n                field: 'resources.url',\n                location: {\n                  phaseNumber: phase.phaseNumber,\n                  weekNumber: week.weekNumber,\n                  topicIndex,\n                  resourceIndex,\n                },\n                suggestion: 'Ensure URL starts with http:// or https://',\n              })\n            }\n          }\n        })\n      })\n\n      // Validate week fields\n      if (week.title && week.title.length > guardrails.weekFields.titleMaxLength) {\n        errors.push({\n          code: 'WEEK_TITLE_TOO_LONG',\n          severity: 'error',\n          message: `Week ${week.weekNumber} title is too long. Maximum is ${guardrails.weekFields.titleMaxLength} characters.`,\n          field: 'title',\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n    })\n  })\n\n  return errors\n}\n\n/**\n * Generates quality warnings (Tier 3)\n */\nexport function generateQualityWarnings(\n  roadmap: Roadmap,\n  guardrails: QualityGuardrails\n): QualityWarning[] {\n  const warnings: QualityWarning[] = []\n\n  roadmap.phases?.forEach(phase => {\n    phase.weeks?.forEach(week => {\n      // Check for no resources\n      const hasResources = week.researchSection?.deepDiveTopics?.some(\n        topic => topic.suggestedResources && topic.suggestedResources.length > 0\n      )\n\n      if (!hasResources) {\n        warnings.push({\n          code: 'NO_RESOURCES',\n          severity: 'warning',\n          message: guardrails.warnings.noResources,\n          suggestion: guardrails.suggestions.resourceRecommendations\n            ? 'Use AI to suggest resources for this week'\n            : undefined,\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n\n      // Check for few deliverables\n      const deliverableCount = week.buildSection?.deliverables?.length || 0\n      if (deliverableCount === 1) {\n        warnings.push({\n          code: 'FEW_DELIVERABLES',\n          severity: 'info',\n          message: guardrails.warnings.fewDeliverables,\n          suggestion: guardrails.suggestions.deliverableSuggestions\n            ? 'Use AI to suggest more deliverables'\n            : undefined,\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n\n      // Check for vague titles\n      if (week.title && isVagueTitle(week.title)) {\n        warnings.push({\n          code: 'VAGUE_TITLE',\n          severity: 'info',\n          message: guardrails.warnings.vagueTitles,\n          suggestion: 'Be specific about technologies and outcomes',\n          location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n        })\n      }\n\n      // Check for missing URLs\n      week.researchSection?.deepDiveTopics?.forEach(topic => {\n        topic.suggestedResources?.forEach(resource => {\n          if (!resource.url || resource.url.trim() === '') {\n            warnings.push({\n              code: 'MISSING_URL',\n              severity: 'warning',\n              message: `\"${resource.title}\": ${guardrails.warnings.missingUrls}`,\n              location: { phaseNumber: phase.phaseNumber, weekNumber: week.weekNumber },\n            })\n          }\n        })\n      })\n    })\n  })\n\n  return warnings\n}\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\n/**\n * Validates if a string is a valid URL\n */\nfunction isValidUrl(url: string): boolean {\n  try {\n    const parsed = new URL(url)\n    return parsed.protocol === 'http:' || parsed.protocol === 'https:'\n  } catch {\n    return false\n  }\n}\n\n/**\n * Checks if a title is too vague\n */\nfunction isVagueTitle(title: string): boolean {\n  const vagueWords = [\n    'learn',\n    'study',\n    'basics',\n    'introduction',\n    'overview',\n    'fundamentals',\n    'getting started',\n  ]\n\n  const lowerTitle = title.toLowerCase()\n  return vagueWords.some(word => lowerTitle.includes(word)) && title.split(' ').length < 5\n}\n"],"names":[],"mappings":"AAAA;;;;;;;CAOC;;;;;;;;;;;;;;;;AAwBM,MAAM,gCAAsD;IACjE,oBAAoB;IACpB,YAAY;IACZ,aAAa,EAAE;IAEf,uBAAuB;QACrB,KAAK;QACL,KAAK;IACP;IAEA,cAAc;QACZ,KAAK;QACL,KAAK;IACP;AACF;AAKO,SAAS,4BACd,OAAgB;IAEhB,MAAM,cAAwB,EAAE;IAEhC,QAAQ,MAAM,EAAE,QAAQ,CAAA;QACtB,MAAM,KAAK,EAAE,QAAQ,CAAA;YACnB,YAAY,IAAI,CAAC,KAAK,UAAU;QAClC;IACF;IAEA,OAAO;QACL,oBAAoB,QAAQ,kBAAkB,IAAI;QAClD,YAAY,QAAQ,MAAM,EAAE,UAAU;QACtC;QACA,uBAAuB,8BAA8B,qBAAqB;QAC1E,cAAc,8BAA8B,YAAY;IAC1D;AACF;AAuCO,MAAM,6BAAgD;IAC3D,cAAc;QACZ,YAAY;QACZ,YAAY;QACZ,gBAAgB;YAAC;SAAc;QAC/B,sBAAsB;IACxB;IAEA,WAAW;QACT,aAAa;QACb,aAAa;QACb,eAAe;QACf,gBAAgB;YAAC;YAAS;SAAO;IACnC;IAEA,OAAO;QACL,WAAW;QACX,eAAe;IACjB;IAEA,gBAAgB;QACd,iBAAiB;YAAE,KAAK;YAAI,KAAK;QAAG;QACpC,oBAAoB;YAAE,KAAK;YAAI,KAAK;QAAG;QACvC,iBAAiB;YAAE,KAAK;YAAG,KAAK;QAAG;IACrC;IAEA,YAAY;QACV,gBAAgB;QAChB,gBAAgB;QAChB,sBAAsB;IACxB;AACF;AAmCO,MAAM,6BAAgD;IAC3D,UAAU;QACR,aAAa;QACb,iBAAiB;QACjB,aAAa;QACb,YAAY;QACZ,cAAc;QACd,oBAAoB;QACpB,aAAa;IACf;IAEA,aAAa;QACX,eAAe;QACf,yBAAyB;QACzB,wBAAwB;IAC1B;AACF;AAkCO,SAAS,8BACd,OAAgB,EAChB,UAAgC;IAEhC,MAAM,SAA4B,EAAE;IAEpC,sCAAsC;IACtC,IAAI,QAAQ,kBAAkB,KAAK,WAAW,kBAAkB,EAAE;QAChE,OAAO,IAAI,CAAC;YACV,MAAM;YACN,UAAU;YACV,SAAS,CAAC,2CAA2C,EAAE,WAAW,kBAAkB,CAAC,OAAO,CAAC;YAC7F,OAAO;QACT;IACF;IAEA,mCAAmC;IACnC,IAAI,QAAQ,MAAM,EAAE,WAAW,WAAW,UAAU,EAAE;QACpD,OAAO,IAAI,CAAC;YACV,MAAM;YACN,UAAU;YACV,SAAS,CAAC,wCAAwC,EAAE,WAAW,UAAU,CAAC,QAAQ,CAAC;YACnF,OAAO;QACT;IACF;IAEA,gCAAgC;IAChC,MAAM,qBAA+B,EAAE;IACvC,QAAQ,MAAM,EAAE,QAAQ,CAAA;QACtB,MAAM,KAAK,EAAE,QAAQ,CAAA;YACnB,mBAAmB,IAAI,CAAC,KAAK,UAAU;QACzC;IACF;IAEA,MAAM,eAAe,WAAW,WAAW,CAAC,MAAM,CAChD,CAAA,IAAK,CAAC,mBAAmB,QAAQ,CAAC;IAEpC,IAAI,aAAa,MAAM,GAAG,GAAG;QAC3B,OAAO,IAAI,CAAC;YACV,MAAM;YACN,UAAU;YACV,SAAS,CAAC,yBAAyB,EAAE,aAAa,IAAI,CAAC,OAAO;YAC9D,OAAO;QACT;IACF;IAEA,0BAA0B;IAC1B,QAAQ,MAAM,EAAE,QAAQ,CAAC,OAAO;QAC9B,MAAM,KAAK,EAAE,QAAQ,CAAC,MAAM;YAC1B,IAAI,KAAK,UAAU,GAAG,WAAW,YAAY,CAAC,GAAG,EAAE;gBACjD,OAAO,IAAI,CAAC;oBACV,MAAM;oBACN,UAAU;oBACV,SAAS,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,mBAAmB,EAAE,WAAW,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC;oBAC3G,OAAO;oBACP,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;YAEA,IAAI,KAAK,UAAU,GAAG,WAAW,YAAY,CAAC,GAAG,EAAE;gBACjD,OAAO,IAAI,CAAC;oBACV,MAAM;oBACN,UAAU;oBACV,SAAS,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,mBAAmB,EAAE,WAAW,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC;oBAC3G,OAAO;oBACP,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;QACF;IACF;IAEA,OAAO;AACT;AAKO,SAAS,2BACd,OAAgB,EAChB,UAA6B;IAE7B,MAAM,SAA4B,EAAE;IAEpC,QAAQ,MAAM,EAAE,QAAQ,CAAA;QACtB,MAAM,KAAK,EAAE,QAAQ,CAAA;YACnB,wBAAwB;YACxB,MAAM,mBAAmB,KAAK,YAAY,EAAE,cAAc,UAAU;YAEpE,IAAI,mBAAmB,WAAW,YAAY,CAAC,UAAU,EAAE;gBACzD,OAAO,IAAI,CAAC;oBACV,MAAM;oBACN,UAAU;oBACV,SAAS,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,KAAK,EAAE,iBAAiB,4BAA4B,EAAE,WAAW,YAAY,CAAC,UAAU,CAAC,CAAC,CAAC;oBAC5H,OAAO;oBACP,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;YAEA,IAAI,mBAAmB,WAAW,YAAY,CAAC,UAAU,EAAE;gBACzD,OAAO,IAAI,CAAC;oBACV,MAAM;oBACN,UAAU;oBACV,SAAS,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,KAAK,EAAE,iBAAiB,0BAA0B,EAAE,WAAW,YAAY,CAAC,UAAU,CAAC,CAAC,CAAC;oBAC1H,OAAO;oBACP,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;YAEA,4BAA4B;YAC5B,KAAK,YAAY,EAAE,cAAc,QAAQ,CAAC,aAAa;gBACrD,IAAI,CAAC,YAAY,WAAW,IAAI,YAAY,WAAW,CAAC,IAAI,OAAO,IAAI;oBACrE,OAAO,IAAI,CAAC;wBACV,MAAM;wBACN,UAAU;wBACV,SAAS,CAAC,YAAY,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,UAAU,CAAC,oBAAoB,CAAC;wBAClF,OAAO;wBACP,UAAU;4BACR,aAAa,MAAM,WAAW;4BAC9B,YAAY,KAAK,UAAU;4BAC3B,kBAAkB;wBACpB;oBACF;gBACF;gBAEA,IAAI,YAAY,WAAW,EAAE,SAAS,WAAW,YAAY,CAAC,oBAAoB,EAAE;oBAClF,OAAO,IAAI,CAAC;wBACV,MAAM;wBACN,UAAU;wBACV,SAAS,CAAC,gCAAgC,EAAE,KAAK,UAAU,CAAC,yBAAyB,EAAE,WAAW,YAAY,CAAC,oBAAoB,CAAC,YAAY,CAAC;wBACjJ,OAAO;wBACP,UAAU;4BACR,aAAa,MAAM,WAAW;4BAC9B,YAAY,KAAK,UAAU;4BAC3B,kBAAkB;wBACpB;oBACF;gBACF;YACF;YAEA,qBAAqB;YACrB,KAAK,eAAe,EAAE,gBAAgB,QAAQ,CAAC,OAAO;gBACpD,MAAM,gBAAgB,MAAM,kBAAkB,EAAE,UAAU;gBAE1D,IAAI,gBAAgB,WAAW,SAAS,CAAC,WAAW,EAAE;oBACpD,OAAO,IAAI,CAAC;wBACV,MAAM;wBACN,UAAU;wBACV,SAAS,CAAC,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,KAAK,UAAU,CAAC,KAAK,EAAE,cAAc,uBAAuB,EAAE,WAAW,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;wBAC7I,OAAO;wBACP,UAAU;4BACR,aAAa,MAAM,WAAW;4BAC9B,YAAY,KAAK,UAAU;4BAC3B;wBACF;oBACF;gBACF;gBAEA,yBAAyB;gBACzB,MAAM,kBAAkB,EAAE,QAAQ,CAAC,UAAU;oBAC3C,IAAI,CAAC,SAAS,KAAK,IAAI,SAAS,KAAK,CAAC,IAAI,OAAO,IAAI;wBACnD,OAAO,IAAI,CAAC;4BACV,MAAM;4BACN,UAAU;4BACV,SAAS,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,KAAK,UAAU,CAAC,cAAc,CAAC;4BACjF,OAAO;4BACP,UAAU;gCACR,aAAa,MAAM,WAAW;gCAC9B,YAAY,KAAK,UAAU;gCAC3B;gCACA;4BACF;wBACF;oBACF;oBAEA,IAAI,WAAW,SAAS,CAAC,aAAa,IAAI,SAAS,GAAG,EAAE;wBACtD,IAAI,CAAC,WAAW,SAAS,GAAG,GAAG;4BAC7B,OAAO,IAAI,CAAC;gCACV,MAAM;gCACN,UAAU;gCACV,SAAS,CAAC,UAAU,EAAE,SAAS,KAAK,CAAC,qBAAqB,CAAC;gCAC3D,OAAO;gCACP,UAAU;oCACR,aAAa,MAAM,WAAW;oCAC9B,YAAY,KAAK,UAAU;oCAC3B;oCACA;gCACF;gCACA,YAAY;4BACd;wBACF;oBACF;gBACF;YACF;YAEA,uBAAuB;YACvB,IAAI,KAAK,KAAK,IAAI,KAAK,KAAK,CAAC,MAAM,GAAG,WAAW,UAAU,CAAC,cAAc,EAAE;gBAC1E,OAAO,IAAI,CAAC;oBACV,MAAM;oBACN,UAAU;oBACV,SAAS,CAAC,KAAK,EAAE,KAAK,UAAU,CAAC,+BAA+B,EAAE,WAAW,UAAU,CAAC,cAAc,CAAC,YAAY,CAAC;oBACpH,OAAO;oBACP,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;QACF;IACF;IAEA,OAAO;AACT;AAKO,SAAS,wBACd,OAAgB,EAChB,UAA6B;IAE7B,MAAM,WAA6B,EAAE;IAErC,QAAQ,MAAM,EAAE,QAAQ,CAAA;QACtB,MAAM,KAAK,EAAE,QAAQ,CAAA;YACnB,yBAAyB;YACzB,MAAM,eAAe,KAAK,eAAe,EAAE,gBAAgB,KACzD,CAAA,QAAS,MAAM,kBAAkB,IAAI,MAAM,kBAAkB,CAAC,MAAM,GAAG;YAGzE,IAAI,CAAC,cAAc;gBACjB,SAAS,IAAI,CAAC;oBACZ,MAAM;oBACN,UAAU;oBACV,SAAS,WAAW,QAAQ,CAAC,WAAW;oBACxC,YAAY,WAAW,WAAW,CAAC,uBAAuB,GACtD,8CACA;oBACJ,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;YAEA,6BAA6B;YAC7B,MAAM,mBAAmB,KAAK,YAAY,EAAE,cAAc,UAAU;YACpE,IAAI,qBAAqB,GAAG;gBAC1B,SAAS,IAAI,CAAC;oBACZ,MAAM;oBACN,UAAU;oBACV,SAAS,WAAW,QAAQ,CAAC,eAAe;oBAC5C,YAAY,WAAW,WAAW,CAAC,sBAAsB,GACrD,wCACA;oBACJ,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;YAEA,yBAAyB;YACzB,IAAI,KAAK,KAAK,IAAI,aAAa,KAAK,KAAK,GAAG;gBAC1C,SAAS,IAAI,CAAC;oBACZ,MAAM;oBACN,UAAU;oBACV,SAAS,WAAW,QAAQ,CAAC,WAAW;oBACxC,YAAY;oBACZ,UAAU;wBAAE,aAAa,MAAM,WAAW;wBAAE,YAAY,KAAK,UAAU;oBAAC;gBAC1E;YACF;YAEA,yBAAyB;YACzB,KAAK,eAAe,EAAE,gBAAgB,QAAQ,CAAA;gBAC5C,MAAM,kBAAkB,EAAE,QAAQ,CAAA;oBAChC,IAAI,CAAC,SAAS,GAAG,IAAI,SAAS,GAAG,CAAC,IAAI,OAAO,IAAI;wBAC/C,SAAS,IAAI,CAAC;4BACZ,MAAM;4BACN,UAAU;4BACV,SAAS,CAAC,CAAC,EAAE,SAAS,KAAK,CAAC,GAAG,EAAE,WAAW,QAAQ,CAAC,WAAW,EAAE;4BAClE,UAAU;gCAAE,aAAa,MAAM,WAAW;gCAAE,YAAY,KAAK,UAAU;4BAAC;wBAC1E;oBACF;gBACF;YACF;QACF;IACF;IAEA,OAAO;AACT;AAEA,+EAA+E;AAC/E,mBAAmB;AACnB,+EAA+E;AAE/E;;CAEC,GACD,SAAS,WAAW,GAAW;IAC7B,IAAI;QACF,MAAM,SAAS,IAAI,IAAI;QACvB,OAAO,OAAO,QAAQ,KAAK,WAAW,OAAO,QAAQ,KAAK;IAC5D,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEA;;CAEC,GACD,SAAS,aAAa,KAAa;IACjC,MAAM,aAAa;QACjB;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,aAAa,MAAM,WAAW;IACpC,OAAO,WAAW,IAAI,CAAC,CAAA,OAAQ,WAAW,QAAQ,CAAC,UAAU,MAAM,KAAK,CAAC,KAAK,MAAM,GAAG;AACzF"}},
    {"offset": {"line": 1708, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/viewer/actions/AddDeliverableButton.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Plus, Save, X } from 'lucide-react';\nimport { DEFAULT_CONTENT_GUARDRAILS } from '@/lib/validation/guardrails';\n\ninterface AddDeliverableButtonProps {\n    weekNumber: number;\n    section: 'build' | 'research' | 'share';\n    currentCount: number;\n    onAdd: (description: string) => Promise<void>;\n}\n\nexport function AddDeliverableButton({\n    weekNumber,\n    section,\n    currentCount,\n    onAdd\n}: AddDeliverableButtonProps) {\n    const [isAdding, setIsAdding] = useState(false);\n    const [description, setDescription] = useState('');\n    const [errors, setErrors] = useState<string[]>([]);\n    const [warnings, setWarnings] = useState<string[]>([]);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n\n    const maxDeliverables = DEFAULT_CONTENT_GUARDRAILS.deliverables.maxPerWeek;\n    const canAdd = currentCount < maxDeliverables;\n\n    const handleAdd = () => {\n        setIsAdding(true);\n        setDescription('');\n        setErrors([]);\n        setWarnings([]);\n    };\n\n    const handleCancel = () => {\n        setIsAdding(false);\n        setDescription('');\n        setErrors([]);\n        setWarnings([]);\n    };\n\n    const handleSave = async () => {\n        // Validate description\n        const errors: string[] = [];\n        const warnings: string[] = [];\n\n        if (!description || description.trim() === '') {\n            errors.push('Deliverable description is required.');\n        } else if (description.length < 10) {\n            warnings.push('Description is very short. Consider being more specific about what needs to be delivered.');\n        }\n\n        // Check for vague terms\n        const vagueTerms = ['complete', 'finish', 'do', 'work on', 'project'];\n        const lowerDesc = description.toLowerCase();\n        const hasVagueTerm = vagueTerms.some(term =>\n            lowerDesc.includes(term) && lowerDesc.split(' ').length < 5\n        );\n\n        if (hasVagueTerm) {\n            warnings.push('Description seems vague. Be specific about what will be delivered (e.g., \"Deploy to Vercel with public URL\").');\n        }\n\n        if (errors.length > 0) {\n            setErrors(errors);\n            setWarnings(warnings);\n            return;\n        }\n\n        setWarnings(warnings);\n\n        try {\n            setIsSubmitting(true);\n            await onAdd(description);\n            setIsAdding(false);\n            setDescription('');\n            setErrors([]);\n            setWarnings([]);\n        } catch (error) {\n            setErrors(['Failed to add deliverable. Please try again.']);\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    if (!canAdd) {\n        return (\n            <div className=\"text-xs text-gray-500 dark:text-gray-400 italic\">\n                Maximum {maxDeliverables} deliverables reached\n            </div>\n        );\n    }\n\n    if (isAdding) {\n        return (\n            <div className=\"p-[var(--space-3)] border-2 border-dashed border-primary/30 rounded-md bg-primary/5 space-y-[var(--space-3)]\">\n                <div>\n                    <label className=\"block text-xs font-medium text-text-secondary mb-1\">\n                        New Deliverable\n                    </label>\n                    <textarea\n                        value={description}\n                        onChange={(e) => setDescription(e.target.value)}\n                        placeholder=\"e.g., Deploy working prototype to Vercel with public URL\"\n                        className={`w-full p-[var(--space-2)] text-sm border border-border rounded-sm focus:outline-none focus:border-primary bg-surface text-text-primary ${errors.length > 0 ? 'border-red-500' : ''\n                            }`}\n                        rows={2}\n                        autoFocus\n                        disabled={isSubmitting}\n                    />\n                </div>\n\n                {/* Errors */}\n                {errors.length > 0 && (\n                    <div className=\"space-y-1\">\n                        {errors.map((error, idx) => (\n                            <p key={idx} className=\"text-xs text-red-600\">\n                                 {error}\n                            </p>\n                        ))}\n                    </div>\n                )}\n\n                {/* Warnings */}\n                {warnings.length > 0 && (\n                    <div className=\"space-y-1\">\n                        {warnings.map((warning, idx) => (\n                            <p key={idx} className=\"text-xs text-yellow-600\">\n                                 {warning}\n                            </p>\n                        ))}\n                    </div>\n                )}\n\n                <div className=\"flex gap-2\">\n                    <button\n                        onClick={handleSave}\n                        disabled={isSubmitting || !description.trim()}\n                        className=\"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-white bg-primary rounded-sm hover:bg-primary-hover disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                    >\n                        <Save className=\"w-3 h-3\" />\n                        {isSubmitting ? 'Adding...' : 'Add'}\n                    </button>\n                    <button\n                        onClick={handleCancel}\n                        disabled={isSubmitting}\n                        className=\"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-text-secondary bg-transparent rounded-sm hover:bg-bg-secondary hover:text-text-primary disabled:opacity-50 transition-colors\"\n                    >\n                        <X className=\"w-3 h-3\" />\n                        Cancel\n                    </button>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <button\n            onClick={handleAdd}\n            className=\"flex items-center gap-1.5 text-xs font-medium text-text-tertiary hover:text-primary transition-colors py-1\"\n        >\n            <Plus className=\"w-3.5 h-3.5\" />\n            Add deliverable\n        </button>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1955, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/hooks/useRoadmapMutations.ts"],"sourcesContent":["/**\n * Hook for managing roadmap mutations (add/remove/update)\n * Handles optimistic updates and validation\n */\n\nimport { useState, useCallback } from 'react';\nimport { useRoadmap } from '@/context/RoadmapContext';\nimport { useApiClient } from '@/lib/api-client';\nimport type { Deliverable, Resource, Week } from '@/lib/types';\n\ninterface MutationOptions {\n    optimistic?: boolean;\n    onSuccess?: () => void;\n    onError?: (error: Error) => void;\n}\n\nexport function useRoadmapMutations() {\n    const { roadmap, setRoadmapDirect } = useRoadmap();\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState<Error | null>(null);\n    const apiClient = useApiClient();\n\n    const persistRoadmap = async (updatedRoadmap: any) => {\n        try {\n            await apiClient.patch(`/api/roadmaps/${updatedRoadmap.id}`, {\n                current_roadmap: updatedRoadmap\n            });\n        } catch (err) {\n            console.error('Failed to persist roadmap:', err);\n            throw err;\n        }\n    };\n\n    /**\n     * Add a deliverable to a week section\n     */\n    const addDeliverable = useCallback(async (\n        weekNumber: number,\n        section: 'build' | 'research' | 'share',\n        description: string,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        const newDeliverable: Deliverable = {\n            description,\n            isCompleted: false,\n        };\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week) {\n                    if (section === 'build' && week.buildSection) {\n                        week.buildSection.deliverables = [\n                            ...(week.buildSection.deliverables || []),\n                            newDeliverable\n                        ];\n                    } else if (section === 'research' && week.researchSection) {\n                        week.researchSection.deliverables = [\n                            ...(week.researchSection.deliverables || []),\n                            newDeliverable\n                        ];\n                    } else if (section === 'share' && week.shareSection) {\n                        week.shareSection.deliverables = [\n                            ...(week.shareSection.deliverables || []),\n                            newDeliverable\n                        ];\n                    }\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n\n            // Rollback optimistic update on error\n            // In a real implementation, we'd restore from a saved state\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Remove a deliverable from a week section\n     */\n    const removeDeliverable = useCallback(async (\n        weekNumber: number,\n        section: 'build' | 'research' | 'share',\n        index: number,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week) {\n                    if (section === 'build' && week.buildSection?.deliverables) {\n                        week.buildSection.deliverables = week.buildSection.deliverables.filter(\n                            (_, i) => i !== index\n                        );\n                    } else if (section === 'research' && week.researchSection?.deliverables) {\n                        week.researchSection.deliverables = week.researchSection.deliverables.filter(\n                            (_, i) => i !== index\n                        );\n                    } else if (section === 'share' && week.shareSection?.deliverables) {\n                        week.shareSection.deliverables = week.shareSection.deliverables.filter(\n                            (_, i) => i !== index\n                        );\n                    }\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Add a resource to a topic\n     */\n    const addResource = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        resource: Omit<Resource, 'url'> & { url: string },\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics?.[topicIndex]) {\n                    const topic = week.researchSection.deepDiveTopics[topicIndex];\n                    topic.suggestedResources = [\n                        ...(topic.suggestedResources || []),\n                        resource\n                    ];\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Remove a resource from a topic\n     */\n    const removeResource = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        resourceIndex: number,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics?.[topicIndex]?.suggestedResources) {\n                    const topic = week.researchSection.deepDiveTopics[topicIndex];\n                    if (topic.suggestedResources) {\n                        topic.suggestedResources = topic.suggestedResources.filter(\n                            (_, i) => i !== resourceIndex\n                        );\n                    }\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Reorder deliverables within a week section\n     */\n    const reorderDeliverables = useCallback(async (\n        weekNumber: number,\n        section: 'build' | 'research' | 'share',\n        startIndex: number,\n        endIndex: number,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week) {\n                    let deliverables: Deliverable[] | undefined;\n                    if (section === 'build') deliverables = week.buildSection?.deliverables;\n                    else if (section === 'research') deliverables = week.researchSection?.deliverables;\n                    else if (section === 'share') deliverables = week.shareSection?.deliverables;\n\n                    if (deliverables) {\n                        const [removed] = deliverables.splice(startIndex, 1);\n                        deliverables.splice(endIndex, 0, removed);\n\n                        if (options?.optimistic !== false) {\n                            setRoadmapDirect(updatedRoadmap);\n                        }\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Reorder resources within a topic\n     */\n    /**\n     * Reorder resources within a topic\n     */\n    const reorderResources = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        startIndex: number,\n        endIndex: number,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics?.[topicIndex]?.suggestedResources) {\n                    const resources = week.researchSection.deepDiveTopics[topicIndex].suggestedResources;\n                    if (resources) {\n                        const [removed] = resources.splice(startIndex, 1);\n                        resources.splice(endIndex, 0, removed);\n\n                        if (options?.optimistic !== false) {\n                            setRoadmapDirect(updatedRoadmap);\n                        }\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Toggle deliverable completion status\n     */\n    const toggleDeliverable = useCallback(async (\n        weekNumber: number,\n        section: 'build' | 'research' | 'share',\n        index: number,\n        isCompleted: boolean,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week) {\n                    let deliverable: Deliverable | undefined;\n                    if (section === 'build') deliverable = week.buildSection?.deliverables?.[index];\n                    else if (section === 'research') deliverable = week.researchSection?.deliverables?.[index];\n                    else if (section === 'share') deliverable = week.shareSection?.deliverables?.[index];\n\n                    if (deliverable) {\n                        deliverable.isCompleted = isCompleted;\n\n                        if (options?.optimistic !== false) {\n                            setRoadmapDirect(updatedRoadmap);\n                        }\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Update deliverable description\n     */\n    const updateDeliverable = useCallback(async (\n        weekNumber: number,\n        section: 'build' | 'research' | 'share',\n        index: number,\n        description: string,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week) {\n                    let deliverable: Deliverable | undefined;\n                    if (section === 'build') deliverable = week.buildSection?.deliverables?.[index];\n                    else if (section === 'research') deliverable = week.researchSection?.deliverables?.[index];\n                    else if (section === 'share') deliverable = week.shareSection?.deliverables?.[index];\n\n                    if (deliverable) {\n                        deliverable.description = description;\n\n                        if (options?.optimistic !== false) {\n                            setRoadmapDirect(updatedRoadmap);\n                        }\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Update resource details\n     */\n    const updateResource = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        resourceIndex: number,\n        resource: Resource,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics?.[topicIndex]?.suggestedResources) {\n                    const resources = week.researchSection.deepDiveTopics[topicIndex].suggestedResources;\n                    if (resources && resources[resourceIndex]) {\n                        resources[resourceIndex] = resource;\n\n                        if (options?.optimistic !== false) {\n                            setRoadmapDirect(updatedRoadmap);\n                        }\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Toggle topic completion status\n     */\n    const toggleTopic = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        isCompleted: boolean,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics?.[topicIndex]) {\n                    week.researchSection.deepDiveTopics[topicIndex].isCompleted = isCompleted;\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Update topic description\n     */\n    const updateTopic = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        description: string,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics?.[topicIndex]) {\n                    week.researchSection.deepDiveTopics[topicIndex].description = description;\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    /**\n     * Remove a topic\n     */\n    const removeTopic = useCallback(async (\n        weekNumber: number,\n        topicIndex: number,\n        options?: MutationOptions\n    ) => {\n        if (!roadmap) {\n            throw new Error('No roadmap loaded');\n        }\n\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const updatedRoadmap = { ...roadmap };\n            const phase = updatedRoadmap.phases.find(p =>\n                p.weeks.some(w => w.weekNumber === weekNumber)\n            );\n\n            if (phase) {\n                const week = phase.weeks.find(w => w.weekNumber === weekNumber);\n                if (week?.researchSection?.deepDiveTopics) {\n                    week.researchSection.deepDiveTopics = week.researchSection.deepDiveTopics.filter(\n                        (_, i) => i !== topicIndex\n                    );\n\n                    if (options?.optimistic !== false) {\n                        setRoadmapDirect(updatedRoadmap);\n                    }\n                }\n            }\n\n            await persistRoadmap(updatedRoadmap);\n\n            options?.onSuccess?.();\n        } catch (err) {\n            const error = err as Error;\n            setError(error);\n            options?.onError?.(error);\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [roadmap, setRoadmapDirect]);\n\n    return {\n        addDeliverable,\n        removeDeliverable,\n        reorderDeliverables,\n        addResource,\n        removeResource,\n        reorderResources,\n        toggleDeliverable,\n        updateDeliverable,\n        updateResource,\n        toggleTopic,\n        updateTopic,\n        removeTopic,\n        isLoading,\n        error,\n    };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2615, "column": 0}, "map": {"version":3,"sources":["file:///Users/lalitshewani/projects/claude/ai_pm_roadmap/roadmap-viewer/frontend/components/ui/DeliverableList.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { CheckCircle2, Circle } from 'lucide-react';\nimport {\n  DndContext,\n  closestCenter,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  DragEndEvent\n} from '@dnd-kit/core';\nimport {\n  arrayMove,\n  SortableContext,\n  sortableKeyboardCoordinates,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\n\nimport { EditableDeliverable } from '../viewer/editable/EditableDeliverable';\nimport { DraggableDeliverable } from '../viewer/dnd/DraggableDeliverable';\nimport { AddDeliverableButton } from '../viewer/actions/AddDeliverableButton';\n\nimport { useRoadmapMutations } from '@/hooks/useRoadmapMutations';\nimport { generateItemId } from '@/lib/progress/tracker';\nimport type { Deliverable, Subtask } from '@/lib/types';\n\ninterface DeliverableListProps {\n  deliverables: Deliverable[] | Subtask[];\n  title?: string;\n  weekNumber?: number;\n  section?: 'build' | 'research' | 'share';\n  roadmapId?: string;\n}\n\nexport default function DeliverableList({\n  deliverables,\n  title,\n  weekNumber = 1,\n  section = 'build',\n  roadmapId = 'default'\n}: DeliverableListProps) {\n\n  const { addDeliverable, removeDeliverable, reorderDeliverables } = useRoadmapMutations();\n\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  const handleDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event;\n\n    if (over && active.id !== over.id) {\n      const oldIndex = deliverables.findIndex((_, i) =>\n        generateItemId(weekNumber, 'deliverable', i, section) === active.id\n      );\n      const newIndex = deliverables.findIndex((_, i) =>\n        generateItemId(weekNumber, 'deliverable', i, section) === over.id\n      );\n\n      if (oldIndex !== -1 && newIndex !== -1) {\n        await reorderDeliverables(weekNumber, section, oldIndex, newIndex);\n      }\n    }\n  };\n\n  const handleToggle = (id: string, checked: boolean) => {\n    // TODO: Call API to update progress\n    console.log('Toggle', id, checked);\n  };\n\n  const handleSave = (id: string, newDescription: string) => {\n    // TODO: Call API to update deliverable\n    console.log('Save', id, newDescription);\n  };\n\n  const handleRemove = async (id: string) => {\n    // Extract index from ID or find it\n    // ID format: w{weekNumber}-deliverable-{index}-{section}\n    // But generateItemId might produce something else.\n    // Let's find the index by iterating.\n    const index = deliverables.findIndex((_, i) =>\n      generateItemId(weekNumber, 'deliverable', i, section) === id\n    );\n\n    if (index !== -1) {\n      await removeDeliverable(weekNumber, section, index);\n    }\n  };\n\n  const renderSubtasks = (subtasks: Subtask[] | undefined) => {\n    if (!subtasks || subtasks.length === 0) return null;\n\n    return (\n      <ul className=\"ml-8 mt-2 space-y-2\">\n        {subtasks.map((subtask, idx) => (\n          <li key={idx} className=\"flex items-start gap-2\">\n            {subtask.isCompleted ? (\n              <CheckCircle2 className=\"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5\" />\n            ) : (\n              <Circle className=\"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5\" />\n            )}\n            <span className={`text-sm ${subtask.isCompleted ? 'text-gray-600 dark:text-gray-400 line-through' : 'text-gray-700 dark:text-gray-300'}`}>\n              {subtask.description}\n            </span>\n          </li>\n        ))}\n      </ul>\n    );\n  };\n\n  if (!deliverables || deliverables.length === 0) {\n    return (\n      <div className=\"space-y-3\">\n        {title && <h4 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">{title}</h4>}\n        <p className=\"text-sm text-gray-500 dark:text-gray-400 italic\">No deliverables yet</p>\n        <AddDeliverableButton\n          weekNumber={weekNumber}\n          section={section}\n          currentCount={0}\n          onAdd={async (description) => {\n            await addDeliverable(weekNumber, section, description);\n          }}\n        />\n      </div>\n    );\n  }\n\n  // Generate IDs for sortable items\n  const items = deliverables.map((_, index) =>\n    generateItemId(weekNumber, 'deliverable', index, section)\n  );\n\n  return (\n    <div className=\"space-y-3\">\n      {title && <h4 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">{title}</h4>}\n\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={items}\n          strategy={verticalListSortingStrategy}\n        >\n          <ul className=\"space-y-3\">\n            {deliverables.map((item, index) => {\n              const id = generateItemId(weekNumber, 'deliverable', index, section);\n              return (\n                <li key={id} className=\"space-y-2\">\n                  <DraggableDeliverable\n                    id={id}\n                    deliverable={item as Deliverable}\n                    weekNumber={weekNumber}\n                    index={index}\n                    section={section}\n                    roadmapId={roadmapId}\n                    isCompleted={item.isCompleted}\n                    onToggle={handleToggle}\n                    onSave={handleSave}\n                    onRemove={handleRemove}\n                  />\n                  {'subtasks' in item && renderSubtasks(item.subtasks)}\n                </li>\n              );\n            })}\n          </ul>\n        </SortableContext>\n      </DndContext>\n\n      {/* Add button - always visible now */}\n      <AddDeliverableButton\n        weekNumber={weekNumber}\n        section={section}\n        currentCount={deliverables.length}\n        onAdd={async (description) => {\n          await addDeliverable(weekNumber, section, description);\n        }}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}